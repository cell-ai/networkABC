<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the networkABC package • networkABC</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using the networkABC package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">networkABC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette.html">Using the networkABC package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fbertran/networkABC">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Using the networkABC package</h1>
                        <h4 class="author">Frédéric Bertrand, Nicolas Jung, Myriam Maumy-Bertrand</h4>
            
            <h4 class="date">2019-02-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/fbertran/networkABC/blob/master/vignettes/vignette.Rmd"><code>vignettes/vignette.Rmd</code></a></small>
      <div class="hidden name"><code>vignette.Rmd</code></div>

    </div>

    
    
<div id="abstract" class="section level1">
<h1 class="hasAnchor">
<a href="#abstract" class="anchor"></a>Abstract</h1>
<p>Elucidating gene regulatory network is an important step towards under- standing the normal cell physiology and complex pathological phenotype. Reverse- engineering consists in using gene expression over time or over different experimental conditions to discover the structure of the gene network in a targeted cellular process. The fact that gene expression data are usually noisy, highly correlated, and have high dimensionality explains the need for specific statistical methods to reverse engineer the underlying network. Among known methods, Approximate Bayesian Computation (ABC) algorithms have not been very well studied. Due to the computational overhead their application is also limited to a small number of genes. In this work we have developed a new multi-level ABC approach that has less computational cost. At the first level, the method captures the global properties of the network, such as scale-freeness and cluster- ing coefficients, whereas the second level is targeted to capture local properties, including the probability of each couple of genes being linked.</p>
</div>
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<div class="figure">
<img src="grapheABC.png" alt="Steps of the network ABC package." width="800"><p class="caption">Steps of the network ABC package.</p>
</div>
</div>
<div id="generation-of-a-network-topology" class="section level1">
<h1 class="hasAnchor">
<a href="#generation-of-a-network-topology" class="anchor"></a>Generation of a network topology</h1>
<p>Load the <code>networkABC</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(networkABC)</code></pre></div>
<div id="examples-and-checks" class="section level2">
<h2 class="hasAnchor">
<a href="#examples-and-checks" class="anchor"></a>Examples and checks</h2>
<p>To generate a network, the number of node and the targeted clustering coefficient should be specified. For example, the following produces a network with 100 nodes and a targeted clustering coefficient of 0.33 :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">net&lt;-<span class="kw"><a href="../reference/network_gen.html">network_gen</a></span>(<span class="dv">100</span>,<span class="fl">0.33</span>)</code></pre></div>
<p>Then, we can plot the network :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(network)
<span class="co">#&gt; Loading required package: network</span>
<span class="co">#&gt; network: Classes for Relational Data</span>
<span class="co">#&gt; Version 1.13.0.1 created on 2015-08-31.</span>
<span class="co">#&gt; copyright (c) 2005, Carter T. Butts, University of California-Irvine</span>
<span class="co">#&gt;                     Mark S. Handcock, University of California -- Los Angeles</span>
<span class="co">#&gt;                     David R. Hunter, Penn State University</span>
<span class="co">#&gt;                     Martina Morris, University of Washington</span>
<span class="co">#&gt;                     Skye Bender-deMoll, University of Washington</span>
<span class="co">#&gt;  For citation information, type citation("network").</span>
<span class="co">#&gt;  Type help("network-package") to get started.</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/network/topics/network">network</a></span>(net<span class="op">$</span>network))</code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>Here is a simulation to show that the algorithm produces networks with a clustering coefficient close to the targeted one</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(PCIT)
<span class="co">#&gt; Loading required package: PCIT</span>
f&lt;-<span class="cf">function</span>(a){
  a&lt;-a[<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/is.finite">is.nan</a></span>(a)]
}</code></pre></div>
<p>We generate 500 networks with 500 nodes with a targeted clustering coefficient of 0.33</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1234</span>)
clco&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="dv">500</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">500</span>){
  N&lt;-<span class="kw"><a href="../reference/network_gen.html">network_gen</a></span>(<span class="dv">500</span>,.<span class="dv">33</span>)<span class="op">$</span>net
  N&lt;-N<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(N)
  clco[i]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(<span class="kw">f</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(PCIT<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/PCIT/topics/clusteringCoefficient">clusteringCoefficient</a></span>(N))))
}</code></pre></div>
<p>Here is the result :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(clco)
<span class="co">#&gt; [1] 0.3306789</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(clco)
<span class="co">#&gt; [1] 0.02874285</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(clco)</code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p>Notice that the algorithm cannot reach all desired values of clustering coefficients, because the network has to be scalefree.</p>
<p>For example, a clustering coefficient of 1 implies that every couple of nodes are linked together ; such a network is obviously not scale-free.</p>
</div>
<div id="details-about-the-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#details-about-the-algorithm" class="anchor"></a>Details about the algorithm</h2>
<p>This algorithm is partially based on the algorithm by Di Camillo, Barbara, Gianna Toffolo, and Claudio Cobelli. ”A gene network simulator to assess reverse engineering algorithms.” <em>Annals of the New York Academy of Sciences</em>.</p>
<p>Let us call <span class="math inline">\(V\)</span> the set of nodes to be connected in the graph <span class="math inline">\(G\)</span> at the current iteration <span class="math inline">\(t\)</span> and <span class="math inline">\(H\)</span> the set of nodes to be connected at iteration <span class="math inline">\(t + 1\)</span>. <span class="math inline">\(V\)</span> is initialized as <span class="math inline">\(V = {1, ...,N}\)</span>, that is, with all the <span class="math inline">\(N\)</span> nodes in <span class="math inline">\(G\)</span>, whereas <span class="math inline">\(H\)</span> is initialized as the empty set <span class="math inline">\(H\)</span>. Nodes are then linked to each other through an iterative procedure, which consists of three main steps, explained in detail below. 1. Three candidate modules are generated. The structure is sampled from a pool of motifs, with possibility of random changes. The number of node of the module is set at random. In this algorithm we have : feedback motif, feedforward motifs and loops. 1. A score is assigned to each module, and one of the three modules is sampled with probability proportional to this score; let us denote the sampled module by M and the number of its nodes by <span class="math inline">\(m\)</span>. 1. <span class="math inline">\(m\)</span> nodes are sampled from <span class="math inline">\(V\)</span> and linked to each other in the graph <span class="math inline">\(G\)</span>, according to the selected module structure <span class="math inline">\(M\)</span>; <span class="math inline">\(V\)</span> is updated by deleting the m sampled nodes; <span class="math inline">\(H\)</span> is updated by adding the nodes. At the end of this process, <span class="math inline">\(V\)</span> is empty whereas <span class="math inline">\(H\)</span> is composed of a lot of motifs. To link the motifs together, we have to choose one node in each motif that is the first position. This set of nodes is then considered as set <span class="math inline">\(V\)</span> .</p>
</div>
</div>
<div id="running-the-abc-algorithm" class="section level1">
<h1 class="hasAnchor">
<a href="#running-the-abc-algorithm" class="anchor"></a>Running the ABC algorithm</h1>
<div id="the-simpliest-way" class="section level2">
<h2 class="hasAnchor">
<a href="#the-simpliest-way" class="anchor"></a>The simpliest way</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)
M&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">30</span>),<span class="dv">10</span>,<span class="dv">3</span>)
result&lt;-<span class="kw"><a href="../reference/abc.html">abcR</a></span>(<span class="dt">data=</span>M)
<span class="co">#&gt; First run of abc to find tolerance</span>
<span class="co">#&gt; ===============================</span>
<span class="co">#&gt; Iteration=1</span>
<span class="co">#&gt; Accepted:1000</span>
<span class="co">#&gt; Probabilities of clustering coefficients:</span>
<span class="co">#&gt; 0.325000 0.349000 0.326000 </span>
<span class="co">#&gt; Tolerance value</span>
<span class="co">#&gt;       5% </span>
<span class="co">#&gt; 4.523488 </span>
<span class="co">#&gt; ===============================</span>
<span class="co">#&gt; Beginning main run of abc</span>
<span class="co">#&gt; ===============================</span>
<span class="co">#&gt; Iteration=1</span>
<span class="co">#&gt; Accepted:45</span>
<span class="co">#&gt; Probabilities of clustering coefficients:</span>
<span class="co">#&gt; 0.488889 0.311111 0.200000 </span>
<span class="co">#&gt; ===============================</span>
<span class="co">#&gt; Iteration=2</span>
<span class="co">#&gt; Accepted:109</span>
<span class="co">#&gt; Probabilities of clustering coefficients:</span>
<span class="co">#&gt; 0.522936 0.266055 0.211009 </span>
<span class="co">#&gt; ===============================</span>
<span class="co">#&gt; Iteration=3</span>
<span class="co">#&gt; Accepted:139</span>
<span class="co">#&gt; Probabilities of clustering coefficients:</span>
<span class="co">#&gt; 0.654676 0.201439 0.143885 </span>
<span class="co">#&gt; ===============================</span>
<span class="co">#&gt; Iteration=4</span>
<span class="co">#&gt; Accepted:163</span>
<span class="co">#&gt; Probabilities of clustering coefficients:</span>
<span class="co">#&gt; 0.705521 0.196319 0.098160 </span>
<span class="co">#&gt; ===============================</span>
<span class="co">#&gt; Iteration=5</span>
<span class="co">#&gt; Accepted:154</span>
<span class="co">#&gt; Probabilities of clustering coefficients:</span>
<span class="co">#&gt; 0.753247 0.181818 0.064935 </span>
<span class="co">#&gt; ===============================</span>
<span class="co">#&gt; Iteration=6</span>
<span class="co">#&gt; Accepted:210</span>
<span class="co">#&gt; Probabilities of clustering coefficients:</span>
<span class="co">#&gt; 0.819048 0.142857 0.038095 </span>
<span class="co">#&gt; ===============================</span>
<span class="co">#&gt; Iteration=7</span>
<span class="co">#&gt; Accepted:200</span>
<span class="co">#&gt; Probabilities of clustering coefficients:</span>
<span class="co">#&gt; 0.860000 0.120000 0.020000 </span>
<span class="co">#&gt; ===============================</span>
<span class="co">#&gt; Iteration=8</span>
<span class="co">#&gt; Accepted:163</span>
<span class="co">#&gt; Probabilities of clustering coefficients:</span>
<span class="co">#&gt; 0.865031 0.110429 0.024540 </span>
<span class="co">#&gt; ===============================</span>
<span class="co">#&gt; Iteration=9</span>
<span class="co">#&gt; Accepted:232</span>
<span class="co">#&gt; Probabilities of clustering coefficients:</span>
<span class="co">#&gt; 0.909483 0.077586 0.012931 </span>
<span class="co">#&gt; ===============================</span>
<span class="co">#&gt; Iteration=10</span>
<span class="co">#&gt; Accepted:238</span>
<span class="co">#&gt; Probabilities of clustering coefficients:</span>
<span class="co">#&gt; 0.907563 0.079832 0.012605</span></code></pre></div>
<p>We can plot the results in three different ways :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">networkABC<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/networkABC/topics/showHp">showHp</a></span>(result)</code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<pre><code>#&gt;   gene.hubs hubs.proba
#&gt; 1         4  0.2282913
#&gt; 2         5  0.2394958
#&gt; 3        10  0.2521008</code></pre>
<p>This plot show the probabilities for each gene of being a hub. The following shows the probability for each couple of genes of being linked :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/showNp.html">showNp</a></span>(result)</code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-11-1.png" width="768"> Specifying a probability cutoff (the minimal probability for which we can say that two genes are linked), we can plot the network :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/showNetwork.html">showNetwork</a></span>(result,<span class="fl">0.3</span>)</code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-12-1.png" width="768"> In this plot, the diameter of a node is linked to its number of childreen whereas the color is linked to the probability for each gene of being a hub.</p>
<p>You can also have a look on the error :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/hist">hist</a></span>(result<span class="op">$</span>dist)</code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
</div>
<div id="using-abc-algorithm-with-full-options" class="section level2">
<h2 class="hasAnchor">
<a href="#using-abc-algorithm-with-full-options" class="anchor"></a>Using ABC algorithm with full options</h2>
<p>You can specify all the arguments of the ABC function: more details in the help manual.</p>
<p>For example :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">result&lt;-<span class="kw"><a href="../reference/abc.html">abcR</a></span>(<span class="dt">data=</span>M,
            <span class="dt">clust_coeffs=</span><span class="fl">0.33</span>, <span class="co">#you can specify more than one clustering coefficient</span>
            <span class="dt">tolerance=</span><span class="fl">3.5</span>, <span class="co">#maximal distance between simulated and real data</span>
            <span class="co"># to accept the network</span>
            <span class="dt">number_hubs=</span><span class="dv">3</span>,<span class="co">#the number of hubs</span>
            <span class="dt">iterations=</span><span class="dv">10</span>, <span class="co">#number of iterations</span>
            <span class="dt">number_networks=</span><span class="dv">1000000</span>,<span class="co">#number of network simulated at each iteration</span>
            <span class="dt">hub_probs=</span><span class="ot">NA</span>,<span class="co">#specify the a priori probabilty for each gene to be a hub</span>
            <span class="dt">neighbour_probs=</span><span class="ot">NA</span>,<span class="co">#specify the a priori probability for each couple</span>
            <span class="co">#of gene to be linked</span>
            <span class="dt">is_probs=</span><span class="dv">1</span>)<span class="co">#set this last option to one.</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#abstract">Abstract</a></li>
      <li><a href="#overview">Overview</a></li>
      <li>
<a href="#generation-of-a-network-topology">Generation of a network topology</a><ul class="nav nav-pills nav-stacked">
<li><a href="#examples-and-checks">Examples and checks</a></li>
      <li><a href="#details-about-the-algorithm">Details about the algorithm</a></li>
      </ul>
</li>
      <li>
<a href="#running-the-abc-algorithm">Running the ABC algorithm</a><ul class="nav nav-pills nav-stacked">
<li><a href="#the-simpliest-way">The simpliest way</a></li>
      <li><a href="#using-abc-algorithm-with-full-options">Using ABC algorithm with full options</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Frederic Bertrand, Myriam Maumy-Bertrand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
